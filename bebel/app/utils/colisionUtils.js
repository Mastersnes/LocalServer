define(["jquery","app/data/elements"],function(b,v){return{check:function(c,d,p,s){var h={x:!1,y:!1},t=p=0;0!=c.x&&(p=Math.abs(c.x)/c.x);0!=c.y&&(t=Math.abs(c.y)/c.y);var q=d.x+20,l=q+p,m=d.y,k=m+t,u=b("#player").width(),r=u-40,n=b("#player").height()-20;b(".hitbox").css({left:l,top:k,width:r,height:n});if(0>k||768<k)h.y=!0;b(".stage .element:not(#player):visible").each(function(){if(-1E3>b(this).offset().left-b(this).width()||b(this).offset().left>b(".game").width()+1E3)return!0;b(this).removeClass("saut");
var a=b(this).attr("id"),a=v.get(a);a.action&&(a.action.dom=b(this),a.action.parent=a);var e=b(this).position().left,f=b(this).position().top,c=b(this).width(),g=b(this).height();b(this).attr("newHitbox")?(g=JSON.parse(b(this).attr("newHitbox")),e=parseInt(g.x),f=parseInt(g.y),c=parseInt(g.w),g=parseInt(g.h)):a&&a.hitbox&&(e+=a.hitbox.x,f+=a.hitbox.y,c=a.hitbox.w,g=a.hitbox.h);k+n>f&&k<f+g&&q+r>e&&q<e+c&&(h.y=a,a.float||(k<f&&(d.y=f-n),m=d.y));l+r>e&&l<e+c&&m+n>f&&m<f+g&&(h.x=a,a.float||(h.y=null,
s.moveEngine.vitesse.y=0,d.x=l>e+c/2?e+c:e-u-10));h.y==a?(b(".hitbox").css({left:e,top:f,width:c,height:g}),b(this).addClass("saut")):a&&a.action&&(a.action.dom.removeAttr("playSound"),a.action.reset&&a.action.reset(s))});if(!h.x||h.x.float)d.x+=c.x;h.y||(d.y+=c.y);0>d.x&&(d.x=0);0>d.y&&(d.y=1);return h}}});